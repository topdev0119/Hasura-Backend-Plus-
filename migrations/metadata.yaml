version: 2
tables:
  - table:
      schema: private
      name: refresh_tokens
    object_relationships:
      - name: user
        using:
          foreign_key_constraint_on: user_id
  - table:
      schema: private
      name: user_accounts
    object_relationships:
      - name: user
        using:
          foreign_key_constraint_on: email
      - name: userByUserId
        using:
          foreign_key_constraint_on: user_id
      - name: userByUsername
        using:
          foreign_key_constraint_on: username
  - table:
      schema: public
      name: users
    object_relationships:
      - name: user_account
        using:
          manual_configuration:
            remote_table:
              schema: private
              name: user_accounts
            column_mapping:
              username: username
      - name: userAccountByEmail
        using:
          manual_configuration:
            remote_table:
              schema: private
              name: user_accounts
            column_mapping:
              email: email
    array_relationships:
      - name: refresh_tokens
        using:
          foreign_key_constraint_on:
            column: user_id
            table:
              schema: private
              name: refresh_tokens
      - name: user_accounts
        using:
          foreign_key_constraint_on:
            column: user_id
            table:
              schema: private
              name: user_accounts
